@if (IsVisible)
{
    <div style="position: fixed; bottom: 20px; right: 20px; z-index: 1050; max-width: 400px;">
        <MudPaper Elevation="8" Class="pa-4">
            <MudStack Spacing="2">
                <MudStack Row="true" Justify="Justify.SpaceBetween" AlignItems="AlignItems.Start">
                    <MudStack Spacing="1" Style="flex-grow: 1;">
                        <MudStack Row="true" AlignItems="AlignItems.Center" Spacing="2">
                            <MudProgressCircular Size="Size.Small" Indeterminate="true" />
                            <MudText Typo="Typo.subtitle1">@Title</MudText>
                        </MudStack>
                        @if (!string.IsNullOrEmpty(Message))
                        {
                            <MudText Typo="Typo.body2" Color="Color.Default">@Message</MudText>
                        }
                        @if (Progress > 0)
                        {
                            <MudProgressLinear Color="Color.Primary" Indeterminate="true" Size="Size.Medium" />
                            <MudText Typo="Typo.body2">@Progress deleted</MudText>
                        }
                    </MudStack>
                    <MudIconButton Icon="@Icons.Material.Filled.Close" 
                                   Color="Color.Error" 
                                   Size="Size.Small" 
                                   OnClick="HandleCancel" />
                </MudStack>
            </MudStack>
        </MudPaper>
    </div>
}

@code {
    [Parameter]
    public bool IsVisible { get; set; }

    [Parameter]
    public string Title { get; set; } = "Processing...";

    [Parameter]
    public string Message { get; set; } = string.Empty;

    [Parameter]
    public int Progress { get; set; }

    [Parameter]
    public EventCallback OnCancel { get; set; }

    private async Task HandleCancel()
    {
        await OnCancel.InvokeAsync();
    }
}
