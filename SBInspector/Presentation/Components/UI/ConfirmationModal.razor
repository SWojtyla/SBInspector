@if (IsVisible)
{
    <MudDialog>
        <TitleContent>
            <MudStack Row="true" AlignItems="AlignItems.Center" Spacing="2">
                <MudIcon Icon="@GetMudIcon(IconClass)" />
                <MudText Typo="Typo.h6">@Title</MudText>
            </MudStack>
        </TitleContent>
        <DialogContent>
            <MudText>@Message</MudText>
        </DialogContent>
        <DialogActions>
            <MudButton OnClick="HandleCancel" StartIcon="@Icons.Material.Filled.Close">Cancel</MudButton>
            <MudButton OnClick="HandleConfirm" Color="@GetButtonColor()" Variant="Variant.Filled" StartIcon="@GetMudIcon(ConfirmIconClass)">@ConfirmText</MudButton>
        </DialogActions>
    </MudDialog>
}

@code {
    [Parameter]
    public bool IsVisible { get; set; }

    [Parameter]
    public string Title { get; set; } = "Confirm Action";

    [Parameter]
    public string Message { get; set; } = "Are you sure?";

    [Parameter]
    public string ConfirmText { get; set; } = "Confirm";

    [Parameter]
    public string IconClass { get; set; } = "bi-question-circle";

    [Parameter]
    public string ConfirmIconClass { get; set; } = "bi-check-lg";

    [Parameter]
    public string ConfirmButtonClass { get; set; } = "btn-primary";

    [Parameter]
    public EventCallback OnConfirm { get; set; }

    [Parameter]
    public EventCallback OnCancel { get; set; }

    private async Task HandleConfirm()
    {
        await OnConfirm.InvokeAsync();
    }

    private async Task HandleCancel()
    {
        await OnCancel.InvokeAsync();
    }

    private string GetMudIcon(string bootstrapIcon)
    {
        return bootstrapIcon switch
        {
            "bi-exclamation-triangle" => Icons.Material.Filled.Warning,
            "bi-trash" => Icons.Material.Filled.Delete,
            "bi-check-lg" => Icons.Material.Filled.Check,
            "bi-arrow-counterclockwise" => Icons.Material.Filled.Refresh,
            "bi-exclamation-triangle-fill" => Icons.Material.Filled.Warning,
            "bi-trash-fill" => Icons.Material.Filled.Delete,
            _ => Icons.Material.Filled.Help
        };
    }

    private Color GetButtonColor()
    {
        return ConfirmButtonClass switch
        {
            "btn-danger" => Color.Error,
            "btn-success" => Color.Success,
            "btn-warning" => Color.Warning,
            "btn-primary" => Color.Primary,
            _ => Color.Primary
        };
    }
}
