@using MudBlazor

@if (IsVisible)
{
    <MudPaper Class="mud-elevation-24" Style="position:fixed;bottom:20px;right:20px;z-index:1300;max-width:400px;min-width:300px;">
        <MudCard>
            <MudCardContent>
                <MudStack Direction="Row" Spacing="2" AlignItems="AlignItems.Start" JustifyContent="JustifyContent.SpaceBetween">
                    <MudStack Spacing="1" Style="flex:1;">
                        <MudText Typo="Typo.h6">
                            <MudIcon Icon="@Icons.Material.Filled.Autorenew" Class="mud-animate-spin" /> @Title
                        </MudText>
                        @if (!string.IsNullOrEmpty(Message))
                        {
                            <MudText Typo="Typo.body2" Color="Color.Secondary">@Message</MudText>
                        }
                        @if (Progress > 0)
                        {
                            <MudProgressLinear Value="@Progress" Color="Color.Primary" Height="20" Class="my-2">
                                <ChildContent>
                                    <MudText Typo="Typo.caption">@Progress deleted</MudText>
                                </ChildContent>
                            </MudProgressLinear>
                        }
                    </MudStack>
                    <MudButton Variant="Variant.Outlined" Color="Color.Error" Size="Size.Small" OnClick="HandleCancel" Title="Cancel operation">
                        <MudIcon Icon="@Icons.Material.Filled.Cancel" /> Cancel
                    </MudButton>
                </MudStack>
            </MudCardContent>
        </MudCard>
    </MudPaper>
}

@code {
    [Parameter]
    public bool IsVisible { get; set; }

    [Parameter]
    public string Title { get; set; } = "Processing...";

    [Parameter]
    public string Message { get; set; } = string.Empty;

    [Parameter]
    public int Progress { get; set; }

    [Parameter]
    public EventCallback OnCancel { get; set; }

    private async Task HandleCancel()
    {
        await OnCancel.InvokeAsync();
    }
}
